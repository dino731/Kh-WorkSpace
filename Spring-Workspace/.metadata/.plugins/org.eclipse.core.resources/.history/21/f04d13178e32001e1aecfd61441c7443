<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="boardMapper">
	<resultMap type="boardtype" id="boardTypeResultSet">
		<id column="BOARD_CD" property="boardCd"/>
		<id column="BOARD_NAME" property="boardName"/>
	</resultMap>
	<resultMap type="board" id="boardResultSet">
		<id column="BOARD_NO" property="boardNo"/>
		<result column="BOARD_TITLE" property="boardTitle"/>
		<result column="BOARD_WRITER" property="boardWriter"/>
		<result column="CREATE_DATE" property="createDate"/>
		<result column="COUNT" property="count"/>
	</resultMap>

	<select id="selectBoardTypeList" resultMap="boardTypeResultSet">
		SELECT *
		FROM BOARD_TYPE
		ORDER BY BOARD_CD
	</select>
	<select id="selectList" parameterType="String" resultMap="boardResultSet">
		SELECT
			BOARD_NO,
			BOARD_TITLE,
			BOARD_WRITER,
			COUNT,
			B.CREATE_DATE
		FROM BOARD B
		JOIN MEMBER M ON B.BOARD_WRITER = M.USER_NO
		WHERE B.STATUS = 'Y' AND BOARD_CD = #{boardCode}
		<if test="keyword != null and keyword != ''">
			AND
			<choose>
				<when test="condition == 'title'">
					BOARD_TITLE LIKE '%${keyword}%'
				</when>
				<when test="condition == 'content'">
					BOARD_CONTENT LIKE '%${keyword}%'
				</when>
				<when test="condition == 'titleAndContent'">
					(BOARD_TITLE LIKE '%${keyword}%'
					OR
					BOARD_CONTENT LIKE '%${keyword}%'
					)
				</when>
				<when test="condition == 'writer'">
					BOARD_WRITER LIKE '%${keyword}%'
				</when>
			</choose>
		</if>
		ORDER BY B.CREATE_DATE DESC
	</select>
	<select id="selectListCount" parameterType="hashmap" resultType="int">
	SELECT count(*)
	FROM BOARD B
	JOIN MEMBER M ON B.BOARD_WRITER = M.USER_NO
	WHERE B.STATUS = 'Y' AND BOARD_CD = #{boardCode}
	ORDER BY B.CREATE_DATE DESC
	</select>

</mapper>
