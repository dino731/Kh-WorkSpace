package com.kh.spring.common.interceptor;

import javax.servlet.http.HttpServletRequest;

import org.springframework.web.servlet.handler.HandlerInterceptorAdapter;

import lombok.extern.slf4j.Slf4j;

@Slf4j
public class LoggingInterceptor extends HandlerInterceptorAdapter {
	
	// 사용자가 사용하고 있는 핸드폰 종류
	static String logMP[] = {"iphonen","ipod","android"};
	
	/*
	 * 모든 경로로 들어오는 요청에 대한 로그를 남기기 위한 메소드 (Controller 호출 전에 실행)
	*/

	@Override
	public boolean preHandle(HttpServletRequest request, HttpservletResponse response, Object handler) throws Exception{
		// 접속된 장비가 무엇인지(웹? mobile)
		String currentDevice = "web";
		String logUA = request.getHeader("user-agent").toLowerCase();
		for(String device : logMP) {
			if(logUA.indexOf(device)>0) {
				currentDevice = "mobile";
				break;
			}
		}
	}
}
